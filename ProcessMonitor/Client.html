<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <title>Product App</title>
  <style>
    table,
    th,
    td {
      border: 1px solid black;
    }
  </style>
</head>

<body>

  <h2>Process table:</h2>
  <table id="tbl_id">
  </table>





  <script src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    var uri = 'http://127.0.0.1:8080/api/process';
    var updateFrequency = 500;
    var reportToken = "";

    function updateProcessesData() {
      function updateProcessTable(json) {
        function getProcessMarkup(record) {
          return '<tr>'
            +' <td>' + record.Id + '</td>'
            + '<td>' + record.Name + '</td>'
            + '<td>' + record.MemoryMbyte + '</td>'
            +'</tr>'
        }

        processTable = $("#tbl_id");
        processTable.empty();
        processTable.append('<tr><th>Id</th><th>Name</th><th>Memory MBytes</th></tr>');
        for (let i = 0; i < json.length; i++) {
          let record = json[i];
          markup = getProcessMarkup(record);
          processTable.append(markup);
        }
      }

      // Send an AJAX request
      $.getJSON(uri, function (data) {
        console.log(data);
        if (!jQuery.isEmptyObject(data)) {
          reportToken = data.ReportToken;
          console.log(reportToken);
          updateProcessTable(data.ProcessRecords);
          console.log('Another update');
        } else{
          console.log('Another update: Nothing to update. Do nothing');
        }
      });

    }

    var dummy = {
      "processes": [
        { "Id": "1", "Name": "Visual Studio" },
        { "Id": "2", "Name": "Chrome Browser" },
        { "Id": "3", "Name": "Starcraft" }
      ]
    };

    $(document).ready(function () {

      setInterval(updateProcessesData, updateFrequency);
    });


  </script>
</body>

</html>